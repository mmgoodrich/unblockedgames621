var TitleState = {preload: function(){addFocusAndDesktopDetection(); world = this; this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL; this.scale.pageAlignHorizontally = true; this.scale.pageAlignVertically = true; game.stage.backgroundColor = "#FFFFFF"; }, create: function() {this.b1s = null; this.b1s = this.game.add.sprite(this.game.world.centerX,320, 'b1s'); this.b1s.anchor.setTo(0.5, 1); var logo = this.game.add.sprite(this.game.world.centerX,20, 'bLogo'); logo.anchor.setTo(0.5, 0); logo.animations.add('idle', null, 6); logo.play('idle',null,true); this.b1 = this.game.add.sprite(this.game.world.centerX,this.game.world.centerY - 100, 'b1'); this.b1.anchor.setTo(0.5, 0.5); this.b1.xx = 1.5; this.b1.yy = 1; this.b1.rot = 0.8; this.b1.hSize = this.b1.width / 2; muPlay('muTitle',1); var btnPlay = world.game.add.sprite(this.game.world.centerX, screenHeight - 60, 'btnPlay'); btnPlay.anchor.setTo(0.5); btnPlay.animations.add('idle', null, 8); btnPlay.play('idle',null,true); btnPlay.inputEnabled = true; btnPlay.events.onInputUp.add(gotoL1, this); game.btnMu = addButtonsTitle('btnMu',-330); game.btnFX = addButtonsTitle('btnFX',330); setMuFXBtns(); game.input.onDown.add(muteButtons); }, update: function(){flyCode(this.b1); } }; function addButtonsTitle(nam,xOff){var b = game.add.sprite(game.world.centerX + xOff, screenHeight - 60, nam); b.anchor.setTo(0.5); b.inputEnabled = true; return b; } function flyCode(b1) {b1s = world.b1s; b1.angle += b1.scale.x * b1.rot; b1.position.x += b1.xx; if(b1.position.x +b1.hSize > screenWidth || b1.position.x -b1.hSize < 0){b1.xx *= -1; b1.scale.x *= -1; } b1.position.y += b1.yy; if(b1.position.y +b1.hSize > world.b1s.position.y || b1.position.y -b1.hSize < 0){b1.yy *= -1; } b1s.position.x = b1.x; b1s.scale.x = 1 - (b1s.position.y - b1.hSize - b1.position.y) / 400; }; function gotoL1(){clickSound(); levl = -1; newState(); }